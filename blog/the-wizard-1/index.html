<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <meta name=viewport content="width=device-width, initial-scale=1"> <meta name=description content="I like tech and stuff"> <meta name=author content="Sebiwi"> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>The Wizard: Ansible, Molecule and Test Driven Development | Sebiwi</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="The Wizard: Ansible, Molecule and Test Driven Development" /> <meta name="author" content="sebiwi" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Magic has existed since the dawn of time. It has always been there, hidden in plain sight, making amazing things possible for those willing to open their eyes and harness its power." /> <meta property="og:description" content="Magic has existed since the dawn of time. It has always been there, hidden in plain sight, making amazing things possible for those willing to open their eyes and harness its power." /> <link rel="canonical" href="https://sebiwi.github.io/blog/the-wizard-1/" /> <meta property="og:url" content="https://sebiwi.github.io/blog/the-wizard-1/" /> <meta property="og:site_name" content="Sebiwi" /> <meta property="og:image" content="https://sebiwi.github.io/assets/images/wizard/wizard-1.jpg" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2017-11-20T08:19:02+01:00" /> <meta name="twitter:card" content="summary_large_image" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@sebiwi" /> <script type="application/ld+json"> {"headline":"The Wizard: Ansible, Molecule and Test Driven Development","dateModified":"2017-11-20T08:19:02+01:00","description":"Magic has existed since the dawn of time. It has always been there, hidden in plain sight, making amazing things possible for those willing to open their eyes and harness its power.","datePublished":"2017-11-20T08:19:02+01:00","image":"https://sebiwi.github.io/assets/images/wizard/wizard-1.jpg","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://sebiwi.github.io/blog/the-wizard-1/"},"url":"https://sebiwi.github.io/blog/the-wizard-1/","author":{"@type":"Person","name":"sebiwi"},"@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://sebiwi.github.io/assets/images/favicon/apple-touch-icon-57x57.png" /> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://sebiwi.github.io/assets/images/favicon/apple-touch-icon-114x114.png" /> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://sebiwi.github.io/assets/images/favicon/apple-touch-icon-72x72.png" /> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://sebiwi.github.io/assets/images/favicon/apple-touch-icon-144x144.png" /> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://sebiwi.github.io/assets/images/favicon/apple-touch-icon-60x60.png" /> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://sebiwi.github.io/assets/images/favicon/apple-touch-icon-120x120.png" /> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://sebiwi.github.io/assets/images/favicon/apple-touch-icon-76x76.png" /> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://sebiwi.github.io/assets/images/favicon/apple-touch-icon-152x152.png" /> <link rel="icon" type="image/png" href="https://sebiwi.github.io/assets/images/favicon/favicon-196x196.png" sizes="196x196" /> <link rel="icon" type="image/png" href="https://sebiwi.github.io/assets/images/favicon/favicon-96x96.png" sizes="96x96" /> <link rel="icon" type="image/png" href="https://sebiwi.github.io/assets/images/favicon/favicon-32x32.png" sizes="32x32" /> <link rel="icon" type="image/png" href="https://sebiwi.github.io/assets/images/favicon/favicon-16x16.png" sizes="16x16" /> <link rel="icon" type="image/png" href="https://sebiwi.github.io/assets/images/favicon/favicon-128.png" sizes="128x128" /> <meta name="application-name" content="&nbsp;"/> <meta name="msapplication-TileColor" content="#FFFFFF" /> <meta name="msapplication-TileImage" content="mstile-144x144.png" /> <meta name="msapplication-square70x70logo" content="mstile-70x70.png" /> <meta name="msapplication-square150x150logo" content="mstile-150x150.png" /> <meta name="msapplication-wide310x150logo" content="mstile-310x150.png" /> <meta name="msapplication-square310x310logo" content="mstile-310x310.png" /> <link rel="canonical" href="https://sebiwi.github.io/blog/the-wizard-1/"> <link rel="alternate" type="application/rss+xml" title="" href="https://sebiwi.github.io/feed.xml" /> <style> @charset "UTF-8"; /*! normalize.css v4.1.1 | MIT License | github.com/necolas/normalize.css */ /** * 1. Change the default font family in all browsers (opinionated). * 2. Prevent adjustments of font size after orientation changes in IE and iOS. */ html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ } /** * Remove the margin: in all browsers (opinionated). */ body { margin: 0; } /* HTML5 display: definitions ========================================================================== */ /** * Add the correct display: in IE 9-. * 1. Add the correct display: in Edge, IE, and Firefox. * 2. Add the correct display: in IE. */ article, aside, details, figcaption, figure, footer, header, main, menu, nav, section, summary { /* 1 */ display: block; } /** * Add the correct display: in IE 9-. */ audio, canvas, progress, video { display: inline-block; } /** * Add the correct display: in iOS 4-7. */ audio:not([controls]) { display: none; height: 0; } /** * Add the correct vertical alignment in Chrome, Firefox, and Opera. */ progress { vertical-align: baseline; } /** * Add the correct display: in IE 10-. * 1. Add the correct display: in IE. */ template, [hidden] { display: none; } /* Links ========================================================================== */ /** * 1. Remove the gray background: on active links in IE 10. * 2. Remove gaps in links underline in iOS 8+ and Safari 8+. */ a { background-color: transparent; /* 1 */ -webkit-text-decoration-skip: objects; /* 2 */ } /** * Remove the outline on focused links when they are also active or hovered * in all browsers (opinionated). */ a:active, a:hover { outline-width: 0; } /* Text-level semantics ========================================================================== */ /** * 1. Remove the bottom border: in Firefox 39-. * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari. */ abbr[title] { border-bottom: none; /* 1 */ text-decoration: underline; /* 2 */ text-decoration: underline dotted; /* 2 */ } /** * Prevent the duplicate application of `bolder` by the next rule in Safari 6. */ b, strong { font-weight: inherit; } /** * Add the correct font weight in Chrome, Edge, and Safari. */ b, strong { font-weight: bolder; } /** * Add the correct font style in Android 4.3-. */ dfn { font-style: italic; } /** * Correct the font size and margin: on `h1` elements within `section` and * `article` contexts in Chrome, Firefox, and Safari. */ h1 { font-size: 2em; margin: 0.67em 0; } /** * Add the correct background: and color: in IE 9-. */ mark { background-color: #ff0; color: #000; } /** * Add the correct font size in all browsers. */ small { font-size: 80%; } /** * Prevent `sub` and `sup` elements from affecting the line height: in * all browsers. */ sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; } sub { bottom: -0.25em; } sup { top: -0.5em; } /* Embedded content ========================================================================== */ /** * Remove the border: on images inside links in IE 10-. */ img { border-style: none; } /** * Hide the overflow in IE. */ svg:not(:root) { overflow: hidden; } /* Grouping content ========================================================================== */ /** * 1. Correct the inheritance and scaling of font size in all browsers. * 2. Correct the odd `em` font sizing in all browsers. */ code, kbd, pre, samp { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */ } /** * Add the correct margin: in IE 8. */ figure { margin: 1em 40px; } /** * 1. Add the correct box sizing in Firefox. * 2. Show the overflow in Edge and IE. */ hr { box-sizing: content-box; /* 1 */ height: 0; /* 1 */ overflow: visible; /* 2 */ } /* Forms ========================================================================== */ /** * 1. Change font properties to `inherit` in all browsers (opinionated). * 2. Remove the margin: in Firefox and Safari. */ button, input, select, textarea { font: inherit; /* 1 */ margin: 0; /* 2 */ } /** * Restore the font weight unset by the previous rule. */ optgroup { font-weight: bold; } /** * Show the overflow in IE. * 1. Show the overflow in Edge. */ button, input { /* 1 */ overflow: visible; } /** * Remove the inheritance of text transform in Edge, Firefox, and IE. * 1. Remove the inheritance of text transform in Firefox. */ button, select { /* 1 */ text-transform: none; } /** * 1. Prevent a WebKit bug where (2) destroys native `audio` and `video` * controls in Android 4. * 2. Correct the inability to style clickable types in iOS and Safari. */ button, html [type="button"], [type="reset"], [type="submit"] { -webkit-appearance: button; /* 2 */ } /** * Remove the inner border: and padding: in Firefox. */ button::-moz-focus-inner, [type="button"]::-moz-focus-inner, [type="reset"]::-moz-focus-inner, [type="submit"]::-moz-focus-inner { border-style: none; padding: 0; } /** * Restore the focus styles unset by the previous rule. */ button:-moz-focusring, [type="button"]:-moz-focusring, [type="reset"]:-moz-focusring, [type="submit"]:-moz-focusring { outline: 1px dotted ButtonText; } /** * Change the border, margin, and padding: in all browsers (opinionated). */ fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; } /** * 1. Correct the text wrapping in Edge and IE. * 2. Correct the color: inheritance from `fieldset` elements in IE. * 3. Remove the padding: so developers are not caught out when they zero out * `fieldset` elements in all browsers. */ legend { box-sizing: border-box; /* 1 */ color: inherit; /* 2 */ display: table; /* 1 */ max-width: 100%; /* 1 */ padding: 0; /* 3 */ white-space: normal; /* 1 */ } /** * Remove the default vertical scrollbar in IE. */ textarea { overflow: auto; } /** * 1. Add the correct box sizing in IE 10-. * 2. Remove the padding: in IE 10-. */ [type="checkbox"], [type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ } /** * Correct the cursor style of increment and decrement buttons in Chrome. */ [type="number"]::-webkit-inner-spin-button, [type="number"]::-webkit-outer-spin-button { height: auto; } /** * 1. Correct the odd appearance in Chrome and Safari. * 2. Correct the outline style in Safari. */ [type="search"] { -webkit-appearance: textfield; /* 1 */ outline-offset: -2px; /* 2 */ } /** * Remove the inner padding: and cancel buttons in Chrome and Safari on OS X. */ [type="search"]::-webkit-search-cancel-button, [type="search"]::-webkit-search-decoration { -webkit-appearance: none; } /** * Correct the text style of placeholders in Chrome, Edge, and Safari. */ ::-webkit-input-placeholder { color: inherit; opacity: 0.54; } /** * 1. Correct the inability to style clickable types in iOS and Safari. * 2. Change font properties to `inherit` in Safari. */ ::-webkit-file-upload-button { -webkit-appearance: button; /* 1 */ font: inherit; /* 2 */ } /* GitHub style for Pygments syntax highlighter, for use with Jekyll * Courtesy of GitHub.com */ .highlight .c { color: #999988; font-style: italic; } .highlight .err { color: #a61717; background-color: #e3d2d2; } .highlight .k { font-weight: bold; } .highlight .o { font-weight: bold; } .highlight .cm { color: #999988; font-style: italic; } .highlight .cp { color: #999999; font-weight: bold; } .highlight .c1 { color: #999988; font-style: italic; } .highlight .cs { color: #999999; font-weight: bold; font-style: italic; } .highlight .gd { color: #000000; background-color: #ffdddd; } .highlight .gd .x { color: #000000; background-color: #ffaaaa; } .highlight .ge { font-style: italic; } .highlight .gr { color: #aa0000; } .highlight .gh { color: #999999; } .highlight .gi { color: #000000; background-color: #ddffdd; } .highlight .gi .x { color: #000000; background-color: #aaffaa; } .highlight .go { color: #888888; } .highlight .gp { color: #555555; } .highlight .gs { font-weight: bold; } .highlight .gu { color: #800080; font-weight: bold; } .highlight .gt { color: #aa0000; } .highlight .kc { font-weight: bold; } .highlight .kd { font-weight: bold; } .highlight .kn { font-weight: bold; } .highlight .kp { font-weight: bold; } .highlight .kr { font-weight: bold; } .highlight .kt { color: #445588; font-weight: bold; } .highlight .m { color: #009999; } .highlight .s { color: #dd1144; } .highlight .n { color: #333333; } .highlight .na { color: teal; } .highlight .nb { color: #0086b3; } .highlight .nc { color: #445588; font-weight: bold; } .highlight .no { color: teal; } .highlight .ni { color: purple; } .highlight .ne { color: #990000; font-weight: bold; } .highlight .nf { color: #990000; font-weight: bold; } .highlight .nn { color: #555555; } .highlight .nt { color: navy; } .highlight .nv { color: teal; } .highlight .ow { font-weight: bold; } .highlight .w { color: #bbbbbb; } .highlight .mf { color: #009999; } .highlight .mh { color: #009999; } .highlight .mi { color: #009999; } .highlight .mo { color: #009999; } .highlight .sb { color: #dd1144; } .highlight .sc { color: #dd1144; } .highlight .sd { color: #dd1144; } .highlight .s2 { color: #dd1144; } .highlight .se { color: #dd1144; } .highlight .sh { color: #dd1144; } .highlight .si { color: #dd1144; } .highlight .sx { color: #dd1144; } .highlight .sr { color: #009926; } .highlight .s1 { color: #dd1144; } .highlight .ss { color: #990073; } .highlight .bp { color: #999999; } .highlight .vc { color: teal; } .highlight .vg { color: teal; } .highlight .vi { color: teal; } .highlight .il { color: #009999; } .highlight .gc { color: #999; background-color: #EAF2F5; } body, html { font-size: 62.5%; } body { line-height: 1; font: 16px "Helvetica Neue", Helvetica, Arial, sans-serif; color: #666; } h1, h2, h3, h4 { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: #222; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; } h1 { font-size: 3rem; letter-spacing: -1px; color: #222; font-weight: 700; } h2 { font-size: 2.2rem; } h3 { font-size: 2rem; } h4 { font-size: 1.6rem; } a { color: #4b0082; text-decoration: underline; } p { line-height: 1.7; color: #666; font-weight: 300; margin-bottom: 20px; letter-spacing: 0.4px; } @media only screen and (max-width: 400px) { p { letter-spacing: 0.2px; } } strong { font-weight: 400; color: #000; } ul li, ol li { line-height: 2.4rem; font-weight: 300; color: #666; } img, pre, iframe { max-width: 100%; } img, pre { border-radius: 4px; } figcaption { position: relative; top: -20px; left: 0; right: 0; margin: 0 auto; width: 100%; text-align: center; font-size: 1.3rem; color: #aaa; font-weight: 300; } @media only screen and (max-width: 400px) { figcaption { font-size: 1.2rem; } } blockquote { padding-left: 15px; border-left: 3px solid #eee; } hr { border: none; height: 1px; margin: 40px auto; background: #eee; width: 100%; } figure.highlight { width: 100%; margin: 0; } code, tt { padding: 1px 0; font-family: "Consolas", Liberation Mono, Menlo, Courier, monospace; font-size: 12px; line-height: 20px; background: #fff; border-radius: 2px; border-radius: 2px; } pre { box-sizing: border-box; margin: 0 0 1.75em 0; width: 100%; padding: 5px 10px; font-family: "Consolas", Liberation Mono, Menlo, Courier, monospace; font-size: 1.2rem; line-height: 2rem; overflow: auto; background: #fff; border: 1px solid #ededed; border-radius: 2px; } .wrapper-normal, .wrapper-large { height: 100%; width: 96%; margin: 0 auto; } @media only screen and (max-width: 400px) { .wrapper-normal, .wrapper-large { width: 88%; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .wrapper-normal, .wrapper-large { width: 88%; } } .wrapper-normal { max-width: 560px; } .wrapper-large { max-width: 810px; } .center-image { margin: 0 auto; display: block; } /* general helpers */ .text-center { text-align: center; } .clearfix:before, .clearfix:after { content: ""; display: table; } .clearfix:after { clear: both; } /* animations */ .animated { animation: fade-in-down 0.6s; animation-delay: 0.3s; animation-fill-mode: both; } @keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } } .home, .blog, .comics, .projects { margin-top: 125px; } .home > .list, .blog > .list, .comics > .list, .projects > .list { border-top: 1px solid #ededed; margin-top: 30px; padding-top: 40px; position: relative; } .home > .list:before, .blog > .list:before, .comics > .list:before, .projects > .list:before { display: block; content: " "; width: 7px; height: 7px; border: #ededed 1px solid; position: absolute; top: -5px; left: 50%; margin-left: -5px; background: #FFF; box-shadow: #FFF 0 0 0 5px; border-radius: 3px; } .home > .list > .item, .blog > .list > .item, .comics > .list > .item, .projects > .list > .item { display: block; width: 95%; margin: 0 auto; } .home > .list > .item > .url, .blog > .list > .item > .url, .comics > .list > .item > .url, .projects > .list > .item > .url { width: 100%; display: block; padding: 20px 0; text-decoration: none; } .home > .list > .item > .url > .title, .blog > .list > .item > .url > .title, .comics > .list > .item > .url > .title, .projects > .list > .item > .url > .title { margin: 0; width: 75%; font-weight: 500; transition: all ease-in-out 0.2s; } .home > .list > .item:hover > .url > .title, .blog > .list > .item:hover > .url > .title, .comics > .list > .item:hover > .url > .title, .projects > .list > .item:hover > .url > .title { color: #4b0082; } .home > .list aside, .blog > .list aside, .comics > .list aside, .projects > .list aside { position: relative; top: 2px; margin: 0; width: 25%; float: right; font-weight: 300; color: #aaa; text-align: right; transition: all ease-in-out 0.2s; } .home > .list .item:hover .url aside, .blog > .list .item:hover .url aside, .comics > .list .item:hover .url aside, .projects > .list .item:hover .url aside { color: #666; } .blog > .list > .item > .url > .title, .comics > .list > .item > .url > .title, .projects > .list > .item > .url > .title { display: inline; } .blog > .list > .item > .url > .emoji, .comics > .list > .item > .url > .emoji, .projects > .list > .item > .url > .emoji { display: inline; position: relative; top: -4px; margin-right: 10px; } .page { margin-top: 125px; } .page > h1 { text-align: center; margin-bottom: 6rem; } .about img { width: 50%; margin: 0 auto; display: block; } .post { margin-top: 125px; } .post > .title { text-align: center; margin-bottom: 3rem; } .post > .date, .post > .post-tags { color: #aaa; font-weight: 300; font-size: 1.4rem; text-transform: uppercase; text-align: center; display: block; margin-bottom: 6rem; letter-spacing: 1px; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; } .post > .date { margin-bottom: 2rem; } .post > .post-tags > .item { padding: 2px 8px; border-radius: 3px; font-size: 1.1rem; background: #ededed; color: #666; letter-spacing: 1px; margin: 3px 1px; text-decoration: none; display: inline-block; } .post > h2, .post > h3, .post > h4 { margin-top: 40px; } .post > h2 a, .post > h3 a, .post > h4 a { text-decoration: none; } .post > .title-image { max-height: 120px; display: block; margin: 0 auto; } .post > .blog-navigation { font-size: 1.4rem; display: block; width: auto; overflow: hidden; } .post > .blog-navigation a { display: block; width: 50%; float: left; margin: 1em 0; } .post > .blog-navigation .next { text-align: right; } .tags { margin-top: 125px; } .tags > .list { border-top: 1px solid #ededed; margin-top: 30px; padding-top: 40px; position: relative; } .tags > .list:before { display: block; content: " "; width: 7px; height: 7px; border: #ededed 1px solid; position: absolute; top: -5px; left: 50%; margin-left: -5px; background: #FFF; box-shadow: #FFF 0 0 0 5px; border-radius: 3px; } .tags > .list > .item { font-weight: 300; text-transform: uppercase; text-align: center; margin-bottom: 6rem; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; padding: 3px 9px; border-radius: 3px; font-size: 1.3rem; background: #ededed; color: #666; letter-spacing: 1px; margin: 0 0.5rem 1rem; text-decoration: none; display: inline-block; } .tag-list > .list { padding: 0; } .tag-list > .list > .item { display: block; width: 80%; margin: 0 10%; } .tag-list > .list > .item > .url { width: 100%; height: 100%; display: block; padding: 20px 0; text-decoration: none; } .tag-list > .list > .item > .url > .title { margin: 0; width: 75%; font-weight: 400; transition: all ease-in-out 0.2s; font-size: 1.6rem; } .tag-list > .list > .item:hover > .url > .title { color: #4b0082; } .tag-list > .list aside { position: relative; top: 2px; margin: 0; width: 25%; float: right; font-weight: 300; color: #aaa; text-align: right; transition: all ease-in-out 0.2s; font-size: 1.6rem; } .tag-list > .list .item:hover .url aside { color: #666; } .author { padding: 3rem 0; border-bottom: 1px solid #ededed; border-top: 1px solid #ededed; max-width: 100%; margin: 4rem auto 0; } .author > .toleft > .selfie { width: 90%; border-radius: 100%; } .author > .toright > .name, .author > .toright > .bio { width: 60%; display: inline-block; } .author > .toright > .name { font-size: 1.5rem; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-weight: 500; margin: 6px 0 0; } @media only screen and (max-width: 400px) { .author > .toright > .name { width: 100%; display: block; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author > .toright > .name { width: 100%; display: block; } } .author > .toright > .bio { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-weight: 300; color: #aaa; font-size: 1.3rem; text-align: justify; line-height: 1.5; margin: 0; } @media only screen and (max-width: 400px) { .author > .toright > .bio { width: 100%; display: block; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author > .toright > .bio { width: 100%; display: block; } } .author > .toleft { width: 10%; display: inline-block; } @media only screen and (max-width: 400px) { .author > .toleft { width: 20%; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author > .toleft { width: 20%; } } .author > .toright { width: 89%; display: inline-block; vertical-align: top; } @media only screen and (max-width: 400px) { .author > .toright { width: 78%; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .author > .toright { width: 78%; } } .no-disqus { border-bottom: none; padding-bottom: 0; } .disqus { margin: 0 auto; max-width: 100%; padding: 40px 0; } .footer-main { border-top: 1px solid #ededed; padding: 40px 0; margin: 40px 0 0; font-size: 1.3rem; color: #aaa; font-weight: 300; text-align: center; position: relative; } .footer-main:before { display: block; content: " "; width: 7px; height: 7px; border: #ededed 1px solid; position: absolute; top: -5px; left: 50%; margin-left: -5px; background: #FFF; box-shadow: #FFF 0 0 0 5px; border-radius: 3px; } .footer-main > .link { display: inline; } .footer-main > .link > .icon { width: 15px !important; fill: #aaa !important; transition: ease-in-out all 0.3s; position: relative; top: 3px; display: inherit; margin: 0; } .footer-main > .link > .icon:hover { fill: #4b0082 !important; } .footer-main > .extra { color: #aaa; margin-top: 0; } .footer-main > .extra > .link { color: #222; text-decoration: none; border-bottom: 1px solid transparent; transition: ease-in-out all 0.3s; padding-bottom: 1px; } .footer-main > .extra > .link:hover { border-color: #aaa; } .header-home { display: block; margin: 0 auto; text-align: center; position: relative; z-index: 99; } .header-home > .link > .selfie { width: 125px; margin-bottom: 25px; border-radius: 100%; transition: all 0.2s; box-shadow: 0; opacity: 1; } .header-home > .link > .selfie:hover { box-shadow: 0 0px 4px 0 rgba(0, 0, 0, 0.18), 0 0px 12px 0 rgba(0, 0, 0, 0.15); opacity: 0.8; } .header-home > .title { font-size: 4rem; margin: 0 0 13px; } .header-home > .description { font-size: 1.85rem; font-weight: 300; font-style: normal; color: #aaa; width: 70%; margin: 0 auto 30px; } .header-home > .description a { font-weight: 200; color: #759fbf; text-decoration: none; } .header-home > .description a:hover { text-decoration: underline; } .nav > .list, .nav-home > .list { list-style: none; margin: 0; padding: 0 13px 0; } .nav > .list > .item, .nav-home > .list > .item { display: inline-block; } .nav > .list > .item > .link, .nav-home > .list > .item > .link { display: inline-block; font-weight: 300; font-size: 1.4rem; padding: 20px 10px; text-decoration: none; } .nav { position: absolute; right: 0; top: 0; } .nav > .list { padding: 0 13px 0; } .nav > .list > .item > .link { font-size: 1.4rem; padding: 20px 10px; } .nav-home { margin-top: 40px; text-align: center; } .nav-home > .list { padding: 0; } .nav-home > .list > .item > .link { font-size: 2rem; padding: 7px 15px; margin: 0; border-radius: 4%; transition: all 0.4s ease-in-out; width: 70px; } .nav-home > .list > .item > .link:hover { color: #666; } .evidence { background-image: linear-gradient(to bottom, rgba(39, 243, 106, 0.15), rgba(39, 243, 106, 0.15)); color: beta; } .star > .url > .title { width: auto !important; display: inline; background-image: linear-gradient(rgba(39, 243, 106, 0.15), rgba(39, 243, 106, 0.15)); } .twitter-tweet { margin: 10px auto; } .icon { display: inline-block; width: 17px; height: 17px; fill: #000; text-align: center; color: #000; margin: 7px auto; } .caption { position: relative; top: 1rem; left: 0; right: 0; margin: 0 auto; width: 100%; text-align: center; font-size: 1.3rem; } .bigger-image { min-width: 130%; margin: 5rem 0 5rem -15%; } @media only screen and (max-width: 400px) { .bigger-image { min-width: 114%; margin: 2rem 0 2rem -7%; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .bigger-image { min-width: 114%; margin: 2rem 0 2rem -7%; } } .breaker { height: 1px; margin: 6rem auto; width: 100%; } .breaker:before { content: "• • •"; width: 100%; text-align: center; display: block; color: #aaa; letter-spacing: 4px; position: relative; top: -8px; } .pagination { width: 95%; margin: 3rem auto 0; text-align: center; } .pagination > .page_number { display: inline-block; font-size: 1.3rem; } .pagination > .previous, .pagination > .next { display: inline-block; font-size: 1.8rem; position: relative; top: 1px; padding: 1px 9px; } .pagination > .hidden { visibility: hidden; } .related { margin: 10rem 0 0rem; } .share { float: right; width: 40%; display: inline; text-align: right; position: relative; top: -10px; } @media only screen and (max-width: 400px) { .share { width: 100%; display: block; top: 0; text-align: left; float: none; margin-top: 5px; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .share { width: 100%; display: block; top: 0; text-align: left; float: none; margin-top: 5px; } } .share > .twitter, .share > .facebook, .share > .google-plus, .share > .linkedin, .share > .reddit { display: inline; vertical-align: middle; font-size: 13px; font-weight: 700; color: #fff; padding: 6px 10px; border-radius: 3px; margin-left: 5px; text-decoration: none; } @media only screen and (max-width: 400px) { .share > .twitter, .share > .facebook, .share > .google-plus, .share > .linkedin, .share > .reddit { margin: 0 5px 10px 0; } } @media only screen and (min-width: 400px) and (max-width: 1050px) { .share > .twitter, .share > .facebook, .share > .google-plus, .share > .linkedin, .share > .reddit { margin: 0 5px 10px 0; } } .share > .twitter { background: #4fafed; } .share > .facebook { background: #4361b3; } .share > .google-plus { background: #dd4b39; } .share > .linkedin { background: #0077b5; } .share > .reddit { background: #ff4500; } .share svg { fill: #fff; position: relative; top: 3px; margin: 0; margin-right: 4px; display: inherit; } @media only screen and (min-width: 780px) { .side-by-side { width: 130%; margin: 6rem 0 6rem -15%; } } @media only screen and (max-width: 780px) { .side-by-side { width: 100%; margin: 4rem 0; } } .side-by-side > .toleft, .side-by-side > .toright { display: inline-block; width: 47.5%; } @media only screen and (max-width: 780px) { .side-by-side > .toleft img, .side-by-side > .toright img { text-align: center; display: block; margin: 0 auto; } } @media only screen and (min-width: 780px) { .side-by-side > .toleft { margin-right: 2%; } } @media only screen and (max-width: 780px) { .side-by-side > .toleft { width: 100%; margin: 0 0 4rem 0; } } @media only screen and (min-width: 780px) { .side-by-side > .toright { margin-left: 2%; vertical-align: top; } } @media only screen and (max-width: 780px) { .side-by-side > .toright { width: 100%; margin: 0 0 4rem 0; } } .side-by-side > .toleft > p, .side-by-side > .toright > p { margin: 0 0 4rem 0; } @media only screen and (max-width: 780px) { .side-by-side > .toleft > p, .side-by-side > .toright > p { margin: 0; } } .social-links { margin-top: 20px; } .social-links > .link { margin: 0; text-decoration: none; position: relative; display: inline-block; height: 35px; width: 35px; } .social-links > .link:hover > .icon { fill: #4b0082; } .social-links > .link:hover:before { opacity: 1; transform: translate3d(0, 0, 0); white-space: nowrap; } .social-links > .link:before { content: attr(data-title); display: inline-block; position: absolute; bottom: -34px; left: -6px; margin: 0 auto; font-size: 13px; padding: 3px 10px; background: #222; color: #fff; border-radius: 2px; height: 22px; line-height: 22px; opacity: 0; transition: opacity 150ms linear, transform 150ms linear, -webkit-transform 150ms linear; transform: translate3d(0, -8px, 0); z-index: 99; } .social-links > .link:after { content: ""; position: absolute; top: 35px; left: 13px; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-bottom: 6px solid #222; opacity: 0; transition: opacity 150ms linear, transform 150ms linear, -webkit-transform 150ms linear; transform: translate3d(0, -8px, 0); z-index: 100; } .social-links > .link:hover:after { opacity: 1; transform: translate3d(0, 0, 0); } .social-links > .icon { transition: all ease-in-out 0.2s; } .spoiler { position: relative; } .spoiler:before { content: ""; background-color: #fafae0; position: absolute; top: 0; bottom: 0; left: 0; right: 0; z-index: 50; } .spoiler:hover:before { display: none; } </style> <!-- Twitter cards --> <meta name="twitter:site" content="@sebiwicb"> <meta name="twitter:creator" content="@sebiwi"> <meta name="twitter:title" content="The Wizard: Ansible, Molecule and Test Driven Development"> <meta name="twitter:description" content="Tech, fun and cookies"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="https://sebiwi.github.io/assets/images/wizard/wizard-1.jpg"> <!-- end of Twitter cards --> </head> <body> <div class="wrapper-normal"> <div class="post"> <nav class="nav"> <ul class="list"> <li class="item"> <a class="link" href="https://sebiwi.github.io/">Home</a> </li> <li class="item"> <a class="link" href="https://sebiwi.github.io/blog">Blog</a> </li> <li class="item"> <a class="link" href="https://sebiwi.github.io/comics">Comics</a> </li> </ul> </nav> <h1 class="title">The Wizard: Ansible, Molecule and Test Driven Development</h1> <span class="date"> <time datetime="20-11-2017">Monday. November 20, 2017</time> - <span class="reading-time" title="Estimated read time"> 32 mins </span> </span> <div class="post-tags"> <a class="item" href="https://sebiwi.github.io/tags/#infrastructure-as-code">infrastructure as code</a> <a class="item" href="https://sebiwi.github.io/tags/#software-craftsmanship">software craftsmanship</a> </div> <h2 id="magic-has-existed-since-the-dawn-of-time">Magic has existed since the dawn of time.</h2> <p>It has always been there, hidden in plain sight, making amazing things possible for those willing to open their eyes and harness its power.</p> <p>You can’t remember the first time you used it, and yet it feels like you’ve never existed without it. You’ve obliterated endless armies of enemies by virtue of spells and enchantments, and you’ve also constructed awe-inspiring marvels from the ground up. As a result, you’re renowned for your overwhelming powers in every single one of your incarnations through time. Everyone knows about <strong>the Wizard</strong>.</p> <p>This affinity with magic grants you the ability to see the real nature of things. Time for example, is not linear (as it was believed to be up until the late 21st century). Sometimes, it is hard to keep up with it…</p> <p>Suddenly you wake up. Or you come into consciousness. What year is it?</p> <ul> <li>So yeah, the output is still red, I really don’t know what else to do.</li> <li>What?</li> </ul> <p>You look to your left. N is sitting right there. He looks at you with mild concern in his eyes.</p> <p><img src="https://sebiwi.github.io/assets/images/wizard/wizard-1.jpg" alt="Wizard" /></p> <ul> <li>Are you okay?</li> <li>Yeah, sorry.</li> <li>As I was saying, I don’t know why this isn’t working.</li> </ul> <p>You look at the spell he is trying to cast. His intention is clear: he wants to share the work of his clan with all the sentient entities in this reality by means of a portal.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># task file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install nginx</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
</code></pre></div></div> <h2 id="it-is-clear-why-he-is-failing">It is clear why he is failing.</h2> <p>He is not taking into account the constraints of his clan’s environment. He must first gather the requirements of his spell, and he’s not looking at the right places. As a matter of fact, he is not looking at all. The answer is simple. Nevertheless…</p> <p>You reflect for a second, wondering if someone even taught N how to properly cast a spell.</p> <ul> <li>How are you testing your role?</li> <li>Hum…</li> <li>Are you testing your role?</li> <li>Yes, of course.</li> <li>How?</li> <li>I run my code on the target machine, and then I hope it doesn’t fail.</li> </ul> <p>You feel betrayed by the sound of his words. This is unacceptable. A whole stack of death spells appear in your head. Breathe, you repeat to yourself. In. Out. You keep going.</p> <ul> <li>Are you aware of the concept of Test-Driven Development?</li> <li>Yeah, I used to work that way all the time when I was doing dev with the team.</li> <li>So you’re familiar with it.</li> <li>Sure, L taught me.</li> </ul> <p>Ah, a familiar name. You like L. You fought together at Desaix, before he started mentoring his own apprentices on the arts of war. He must have taught N a thing or two. You wonder if he will be capable of surviving the trial.</p> <ul> <li>Why don’t you test your code that way instead?</li> <li>Because it is not Java, it’s Ansible.</li> <li>So?</li> <li>It’s not the same.</li> <li>Let’s start over. Do you mind if I grab the keyboard?</li> <li>Not at all.</li> </ul> <p>You harness your energy as you get ready to cast your first spell. You feel alive again. You’re in familiar grounds. Before you start working, you need an empty canvas, a playground to construct the structure and robustness of your magic. An isolated enclosure which will allow you to try and cast your spells, and which also follows the same rules as the target reality for the spell you’re trying to create.</p> <ul> <li>Have you ever heard of Molecule?</li> <li>…hum?</li> <li>It’s a Python tool. It allows you to test your Ansible code on many different levels, using local infrastructure.</li> <li>Local? Like a Virtual Machine?</li> </ul> <p>He’s fast. Time to make a choice. The Wanderer, or the Whale? The Whale is indeed faster.</p> <ul> <li>Not necessarily. You can use different providers. Vagrant and Docker are the most common if you want to work locally. We’re going to use Docker, since containers have a faster start-up time.</li> <li>Right on, Docker!</li> </ul> <p>The Whale it is. You concentrate and cast your first incantation.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule init role <span class="nt">--role-name</span> nginx <span class="nt">--driver-name</span> docker
</code></pre></div></div> <p>You feel the energy flowing through. A whirlpool of blue water forms in the sky, and The Whale appears from inside of it. It comes swimming down through the air, looking at you both, and sings its song loudly. An empty enclosure materializes out of thin air, trapping you and N inside of it. The Whale disappears from the whirlpool where it came, right before the whirlpool itself vanishes into nothingness, as fast as it had appeared.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--</span><span class="o">&gt;</span> Initializing new role nginx…

nginx/
├── README.md
├── defaults
│   └── main.yml
├── handlers
│   └── main.yml
├── meta
│   └── main.yml
├── molecule
│   └── default
│       ├── Dockerfile.j2
│       ├── INSTALL.rst
│       ├── create.yml
│       ├── destroy.yml
│       ├── molecule.yml
│       ├── playbook.yml
│       └── tests
│           └── test_default.py
├── tasks
│   └── main.yml
└── vars
    └── main.yml
</code></pre></div></div> <h2 id="you-feel-the-need-to-test-n">You feel the need to test N.</h2> <p>He’s looking at what you’ve produced, his eyebrows frowning.</p> <ul> <li>What do you think? It’s the standard role structure, isn’t it? - you ask, naively</li> <li>Yes, with the exception of the molecule directory with all of that stuff in it.</li> </ul> <p>Good. He realises there’s a difference. How can you easily explain the fact that, in order to control such an enclosure, you need intermediate spells to both create it and destroy it at will? You decide that it is not important right now, you’ll come back later to it.</p> <ul> <li>Don’t think about it yet. Let’s see if our test framework is working properly.</li> </ul> <p>You concentrate and you cast the spell on the enclosure/playground.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule <span class="nb">test</span>

<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── destroy
    ├── dependency
    ├── syntax
    ├── create
    ├── converge
    ├── idempotence
    ├── lint
    ├── side_effect
    ├── verify
    └── destroy
</code></pre></div></div> <p>N is impressed by the fireworks. He has so many questions. You feel overjoyed, but you give him a second so that he can get his ideas together.</p> <ul> <li>Test matrix? Default? And what are all of those things?</li> <li>When I talked about testing Ansible code on many different levels, this is what I meant. The default scenario is what gets executed when you type <code class="highlighter-rouge">molecule test</code> on your terminal, and it contains all of these actions: destroy, dependency, syntax, create, converge, idempotence…</li> <li>Yeah, I can read.</li> </ul> <h4 id="snarky">Snarky.</h4> <p>He wants you to know he’s not a child. He contemplates the enclosure’s structure. You wait for a while until he starts talking again.</p> <ul> <li>Are these… actions executed in order?</li> <li>Yes, unless you say otherwise.</li> <li>What do you mean?</li> </ul> <p>You decide now is the time to go down the rabbit hole.</p> <ul> <li>Since I typed <code class="highlighter-rouge">molecule test</code>, molecule executes the default test sequence, which corresponds to all of these actions. We can also redefine different sequences for different targets if the default test sequence does not satisfy our testing criteria.</li> <li>Different sequences? Like skipping all tests? Or executing only… let’s say… the linting?</li> <li>Sure.</li> </ul> <p>You raise your hand, and you snap your fingers. You hear warping sounds as the enclosure somehow shifts. Everything looks the same, yet everything feels different.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># molecule.yml</span>
<span class="nn">---</span>
<span class="na">dependency</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">galaxy</span>
<span class="na">driver</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">docker</span>
<span class="na">lint</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">yamllint</span>
<span class="na">platforms</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">instance</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">centos:7</span>
<span class="na">provisioner</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ansible</span>
  <span class="na">lint</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">ansible-lint</span>
<span class="na">scenario</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">test_sequence</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">lint</span>
<span class="na">verifier</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">testinfra</span>
  <span class="na">lint</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">flake8</span>
</code></pre></div></div> <p>You take a deep breath, and you cast the spell again.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span> molecule <span class="nb">test</span>
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    └── lint
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'lint'</span>
<span class="nt">--</span><span class="o">&gt;</span> Executing Yamllint on files found <span class="k">in</span> /private/tmp/test/nginx/...
Lint completed successfully.
<span class="nt">--</span><span class="o">&gt;</span> Executing Flake8 on files found <span class="k">in</span> /private/tmp/test/nginx/molecule/default/tests/...
Lint completed successfully.
<span class="nt">--</span><span class="o">&gt;</span> Executing Ansible Lint on /private/tmp/test/nginx/molecule/default/playbook.yml...
Lint completed successfully.
</code></pre></div></div> <p>Once you’re finished, you look back at N. He gets where you’re going.</p> <ul> <li>That was faster.</li> <li>Yes.</li> <li>I think we should add some actions back though.</li> <li>I agree. Which ones?</li> <li>Let me see the first test matrix we saw.</li> </ul> <p>He studies the playground spells thoroughly.</p> <ul> <li>Why is the destroy action executed first?</li> <li>Because the whole point is to be able to test that your role works in newly created infrastructure.</li> <li>Yeah, but it’s going to take longer if I need to create and destroy the container each time I launch my test, right?</li> </ul> <p>Good. He is connecting the dots, seeing outside of the box. You decide that you like N a little better now. Enough to keep the game going.</p> <ul> <li>Yes, but we will deal with that later. Just concentrate on the actions that we should execute in order to fully test our role.</li> <li>Okay, so then we need <code class="highlighter-rouge">destroy</code>… what is <code class="highlighter-rouge">dependency</code>?</li> <li>It allows you to pull dependencies from the galaxy, if you need them.</li> <li>Ah, let’s skip that then. What’s the difference between <code class="highlighter-rouge">syntax</code> and <code class="highlighter-rouge">lint</code>?</li> <li>The <code class="highlighter-rouge">syntax</code> action runs your playbook using the <code class="highlighter-rouge">--syntax-check</code> option native in Ansible, whereas <code class="highlighter-rouge">lint</code> checks your files using flake8, yamllint and ansible-lint.</li> <li>So <code class="highlighter-rouge">create</code> uses the create.yml file we just saw under the molecule directory inside the role right?</li> <li>Yes. It creates a Docker container suitable for Ansible use. And <code class="highlighter-rouge">destroy</code> uses the destroy.yml file. They’re both playbooks, so these actions are managed by Ansible.</li> <li>Eat your own dog food, alright. So <code class="highlighter-rouge">converge</code> executes my role on the container?</li> <li>That’s right.</li> <li>What about <code class="highlighter-rouge">side-effect</code> and <code class="highlighter-rouge">verify</code>?</li> <li><code class="highlighter-rouge">side-effect</code> lets you produce situations in which you will be able to test more things, like HA failover, for example. I don’t think we’ll be needing that one for this situation. And <code class="highlighter-rouge">verify</code> is where all the magic happens. That’s where our unit tests get executed.</li> <li>Unit tests? What?</li> <li>You’ll see in a second.</li> <li>Alright. So I guess we’ll need <code class="highlighter-rouge">destroy</code>, <code class="highlighter-rouge">syntax</code>, <code class="highlighter-rouge">lint</code>, <code class="highlighter-rouge">create</code>, <code class="highlighter-rouge">converge</code>, <code class="highlighter-rouge">verify</code> and <code class="highlighter-rouge">destroy</code> again. No, wait. No destroy at the end. That’s why it is at the beginning.</li> <li>As you wish.</li> </ul> <p>You notice something is missing, but you decide to keep going to take advantage of the synergy. You will get back to it, eventually. You snap your fingers once again, altering the enclosure to match his words.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># molecule.yml</span>
<span class="nn">...</span>
<span class="na">scenario</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">test_sequence</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">destroy</span>
    <span class="pi">-</span> <span class="s">syntax</span>
    <span class="pi">-</span> <span class="s">lint</span>
    <span class="pi">-</span> <span class="s">create</span>
    <span class="pi">-</span> <span class="s">converge</span>
    <span class="pi">-</span> <span class="s">verify</span>
</code></pre></div></div> <p>You cast the spell once again, using the modified reality of the enclosure. The fireworks appear one more time, this time slightly smaller.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span> molecule <span class="nb">test</span>
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── destroy
    ├── syntax
    ├── lint
    ├── create
    ├── converge
    └── verify
</code></pre></div></div> <h3 id="n-seems-happy">N seems happy.</h3> <p>He understands how it works. You take advantage of his motivation to feed him more knowledge.</p> <ul> <li>This is going to act as our full test scenario. We’re not going to run all of that every single time we test though.</li> <li>Hum? Why not? What are we doing instead?</li> </ul> <p>Knowledge is power. Everyone knows that. If you’re able to acquire knowledge faster, you’re able to acquire power faster as well.</p> <ul> <li>Because we want our feedback loop to be as short and quick as possible. So we’re going to <code class="highlighter-rouge">create</code> our resources, <code class="highlighter-rouge">converge</code> them with our Ansible role, and <code class="highlighter-rouge">verify</code> that the results are what we expect. You can do this by typing <code class="highlighter-rouge">molecule create</code>, <code class="highlighter-rouge">molecule converge</code> and <code class="highlighter-rouge">molecule verify</code>. Then, if it all works, we’re going to run our whole test sequence.</li> </ul> <p>You let that sink in for a while, hoping that he doesn’t give up. You look outside the window. It’s raining. You like rain. At least on Earth. It’s better than on Venus, where it melts the skin off of your bones if you don’t cast a protection enchantment around you. That is if the temperature or the pressure don’t get you first. N doesn’t give up. He looks at you.</p> <ul> <li>Okay, I think I have it. Let’s create the container.</li> </ul> <p>You start summoning The Whale again, but you only hear its song this time. It is as loud as it was before. The enclosure disappears and reappears around you.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule create
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    └── create
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'create'</span>
</code></pre></div></div> <p>You look at N, and you think about the next steps. This is going to sound familiar to him.</p> <ul> <li>Let’s run our tests. They are located on the test_default.py file, under the molecule directory.</li> </ul> <p>You clap your hands once, loudly. As you separate them a stream of shiny green light emanates from them.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nv">$molecule</span> verify
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    └── verify
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'verify'</span>
<span class="nt">--</span><span class="o">&gt;</span> Executing Testinfra tests found <span class="k">in</span> /private/tmp/test/nginx/molecule/default/tests/...
    Verifier completed successfully.
</code></pre></div></div> <p>Everything is okay, for now. Back to N.</p> <ul> <li>What are the three steps of Test-Driven Development?</li> <li>Red, green, refactor.</li> </ul> <p>L had done his job right.</p> <ul> <li>Excellent. What are you trying to accomplish?</li> <li>I want to expose my web app using nginx.</li> <li>What do you need for that?</li> <li>Well, I need to install nginx.</li> <li>Let’s go to red then.</li> </ul> <p>You spawn a glob of energy with your hands and use it to craft a rule within the enclosure’s reality:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">testinfra.utils.ansible_runner</span>

<span class="n">testinfra_hosts</span> <span class="o">=</span> <span class="n">testinfra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">ansible_runner</span><span class="o">.</span><span class="n">AnsibleRunner</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'MOLECULE_INVENTORY_FILE'</span><span class="p">])</span><span class="o">.</span><span class="n">get_hosts</span><span class="p">(</span><span class="s">'all'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">test_nginx_is_installed</span><span class="p">(</span><span class="n">host</span><span class="p">):</span>
    <span class="c"># Given</span>
    <span class="n">nginx</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">package</span><span class="p">(</span><span class="s">'nginx'</span><span class="p">)</span>

    <span class="c"># Then</span>
    <span class="k">assert</span> <span class="n">nginx</span><span class="o">.</span><span class="n">is_installed</span>
</code></pre></div></div> <ul> <li>This feels familiar.</li> <li>It’s because it is.</li> </ul> <p>You clap your hands together, just as you did a minute ago. Nevertheless, red shiny light appears this time as you separate them.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule verify

<span class="o">===================================</span> FAILURES <span class="o">===================================</span>
_________________ test_nginx_is_installed[ansible://instance] __________________

host <span class="o">=</span> &lt;testinfra.host.Host object at 0x10a9a7350&gt;

    def test_nginx_is_installed<span class="o">(</span>host<span class="o">)</span>:
        <span class="c"># Given</span>
        nginx <span class="o">=</span> host.package<span class="o">(</span><span class="s1">'nginx'</span><span class="o">)</span>

        <span class="c"># Then</span>
<span class="o">&gt;</span>       assert nginx.is_installed
E       assert False
E        +  where False <span class="o">=</span> &lt;package nginx&gt;.is_installed

tests/test_default.py:14: AssertionError
</code></pre></div></div> <ul> <li>See? That’s red. We’re good. What’s next?</li> <li>Green. So now we’ll add the task we need in order to install the server.</li> </ul> <p>You close your eyes and concentrate. The structure of the spell N had in the first place is recreated from the ground.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># tasks file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install nginx</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
</code></pre></div></div> <p>Back to square one. It is now the same spell N had when he asked you for help. You cast the spell, knowing what will happen beforehand.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nv">$molecule</span> converge
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── create
    └── converge
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'create'</span>
Skipping, instances already created.
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'converge'</span>

    TASK <span class="o">[</span>nginx : Install nginx] <span class="k">***************************************************</span>
    fatal: <span class="o">[</span>instance]: FAILED! <span class="o">=&gt;</span> <span class="o">{</span><span class="s2">"changed"</span>: <span class="nb">false</span>, <span class="s2">"failed"</span>: <span class="nb">true</span>, <span class="s2">"msg"</span>: <span class="s2">"No package matching 'nginx' found available, installed or updated"</span>, <span class="s2">"rc"</span>: 126, <span class="s2">"results"</span>: <span class="o">[</span><span class="s2">"No package matching 'nginx' found available, installed or updated"</span><span class="o">]}</span>
</code></pre></div></div> <p>No fireworks. N seems discouraged. You think about giving him a little push. He deserves it. It’s not about the magic itself, it’s about context. He’s not getting the sources for his portal from the right index. He needs the Epel codex.</p> <ul> <li>At least it’s easier to test now.</li> <li>Don’t be sad. The nginx package is contained within the epel-release repository.</li> <li>What? You could have told me that from the beginning, couldn’t you?</li> <li>We wouldn’t be talking about infrastructure testing if I had, would we?</li> </ul> <p>He smiles. He’s getting in the game, getting the feel of the mindset. He likes it.</p> <ul> <li>Let’s try it again.</li> </ul> <p>You modify the structure of the spell once again, specifying that you want your portal to be created following the instructions on the Epel codex.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># tasks file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install epel release</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">epel-release</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install nginx</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
</code></pre></div></div> <p>You cast the spell, with the new structure.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule converge
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── create
    └── converge
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'create'</span>
Skipping, instances already created.
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'converge'</span>
…
    PLAY RECAP <span class="k">*********************************************************************</span>
    instance                   : <span class="nv">ok</span><span class="o">=</span>3    <span class="nv">changed</span><span class="o">=</span>2    <span class="nv">unreachable</span><span class="o">=</span>0    <span class="nv">failed</span><span class="o">=</span>0
</code></pre></div></div> <p>The spell works, or at least it seems to work. The fireworks make the air vibrate within the enclosure. N seems happy. He doesn’t have the right reflexes yet. Can you blame him? It’s his first existence, and he’s just starting to play with magic. He won’t realize that his portal is not yet active, he’s just dazzled with the fireworks. It’s time for a new trial.</p> <ul> <li>Excellent! I guess we’re done!</li> <li>Yeah. Did you try it?</li> <li>Oh right, let’s see. Can I login to the container somehow?</li> <li>Yeah, <code class="highlighter-rouge">molecule login</code>.</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@instance /]# curl localhost
curl: <span class="o">(</span>7<span class="o">)</span> Failed to connect to ::1: Cannot assign requested address
</code></pre></div></div> <ul> <li>Hm. But… ah, right! I never started the service.</li> <li>Be my guest, add the missing code needed to do it.</li> </ul> <p>He is about to modify the spell’s structure, when he suddenly stops. He looks at you.</p> <ul> <li>No. It’s not the right way. Can’t I test that first?</li> </ul> <p>He passed the test. He might make a good disciple. You start to understand why L started teaching in the first place.</p> <ul> <li>Sure, just add another test.</li> <li>Alright…</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_nginx_is_running</span><span class="p">(</span><span class="n">host</span><span class="p">):</span>
    <span class="c"># Given</span>
    <span class="n">nginx</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="s">'nginx'</span><span class="p">)</span>

    <span class="c"># Then</span>
    <span class="k">assert</span> <span class="n">nginx</span><span class="o">.</span><span class="n">is_running</span>
</code></pre></div></div> <ul> <li>I love writing tests in Python by the way. It’s way simpler than in Java.</li> <li>Don’t let L hear you say that. Try it.</li> </ul> <p>You know the Whale won’t let N get away with that, but you want to see him try. Failure is part of the learning process. It is almost more important than success. It’s the only way he can learn to get up and keep trying.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule verify
    E       AssertionError: Unexpected <span class="nb">exit </span>code 1 <span class="k">for </span>CommandResult<span class="o">(</span><span class="nb">command</span><span class="o">=</span>u<span class="s1">'systemctl is-active nginx'</span>, <span class="nv">exit_status</span><span class="o">=</span>1, <span class="nv">stdout</span><span class="o">=</span>u<span class="s1">''</span>, <span class="nv">stderr</span><span class="o">=</span>u<span class="s1">'Failed to get D-Bus connection: Operation not permitted'</span><span class="o">)</span>
</code></pre></div></div> <p>N claps his hands like you did before, but no light appears as he separated his hands. He looks as you, confused.</p> <ul> <li>Hm, this doesn’t look like the good kind of red. It is not an assertion error.</li> <li>It is not. Testinfra (your Python unit testing library) uses Systemd, Upstart or SysV in order to test if the services are running. Docker containers don’t have an init system. They do have Tini, but it doesn’t work the same way.</li> <li>So I need to change the image that I’m using. Is there a Centos image that includes Systemd?</li> <li>Yeah, it’s called centos/systemd.</li> <li>Go figure. Where can I modify that?</li> <li>On the molecule.yml file. You will need to specify the container’s command instruction in order to start Systemd, because Molecule overrides it by default. You will also need a privileged container, since Systemd requires CAP_SYS_ADMIN and non-privileged containers do not have that capability.</li> <li>Hum, I didn’t quite get all of that, but I think I’ll ask you about it again tomorrow. Let me redo the configuration.</li> </ul> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">platforms</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">instance</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">centos/systemd</span>
    <span class="na">privileged</span><span class="pi">:</span> <span class="s">True</span>
    <span class="na">command</span><span class="pi">:</span> <span class="s">/usr/sbin/init</span>
</code></pre></div></div> <p>The Whale will surely accept this offering. You know it will not reject your summoning anymore. N verifies the spell again.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule <span class="nb">test</span>
<span class="o">===================================</span> FAILURES <span class="o">===================================</span>
____________ test_nginx_is_running_and_enabled[ansible://instance] _____________

host <span class="o">=</span> &lt;testinfra.host.Host object at 0x110adff50&gt;

    def test_nginx_is_running<span class="o">(</span>host<span class="o">)</span>:
        <span class="c"># Given</span>
        nginx <span class="o">=</span> host.service<span class="o">(</span><span class="s1">'nginx'</span><span class="o">)</span>

        <span class="c"># Then</span>
<span class="o">&gt;</span>       assert nginx.is_running
E       assert False
E        +  where False <span class="o">=</span> &lt;service nginx&gt;.is_running

tests/test_default.py:20: AssertionError

<span class="nt">--</span> Docs: http://doc.pytest.org/en/latest/warnings.html
<span class="o">================</span> 1 failed, 1 passed, 1 warnings <span class="k">in </span>6.74 seconds <span class="o">================</span>
</code></pre></div></div> <ul> <li>Done, we’re back to red. Now I’ll make the changes in order to start the service.</li> </ul> <p>You smile as you see N craft. He is not ready yet, but he is well under way. You feel proud of him.</p> <ul> <li>Alright, I’m done. What do you think?</li> </ul> <p>He shows you the structure of his spell.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># tasks file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install epel release</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">epel-release</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install nginx</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Start nginx</span>
  <span class="na">command</span><span class="pi">:</span> <span class="s">systemctl start nginx</span>
</code></pre></div></div> <p>All of your previously found pride turns into disappointment. This is preposterous. It can’t be serious. He can’t be serious. He should understand that you can’t be spawning portals indefinitely. The results could be catastrophic.</p> <p>But then…you contemplate him. You realize he’s tired. Idempotence is a hard concept to grasp too. Benjamin Peirce taught it for over 50 years at Harvard. You remember the first time Merlin brought you to an enclosure like this one. Just the memory of it makes you feel goosebumps on the back of your neck.</p> <p>You decide that you’re going to let him continue, for education purposes only. He’ll realize the problem with his proposal.</p> <ul> <li>Why don’t you try it?</li> </ul> <p>He casts the spell himself.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule converge
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── create
    └── converge
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'create'</span>
Skipping, instances already created.
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'converge'</span>

    PLAY RECAP <span class="k">*********************************************************************</span>
    instance                   : <span class="nv">ok</span><span class="o">=</span>4    <span class="nv">changed</span><span class="o">=</span>1    <span class="nv">unreachable</span><span class="o">=</span>0    <span class="nv">failed</span><span class="o">=</span>0
</code></pre></div></div> <p>Right after the fireworks, a green portal appears right in front of both of you. It seems to work.</p> <ul> <li>Great. I’ll verify now.</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule verify
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    └── verify
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'verify'</span>
<span class="nt">--</span><span class="o">&gt;</span> Executing Testinfra tests found <span class="k">in</span> /Users/sebiwi/stuff/test/nginx/molecule/default/tests/...
    <span class="o">=============================</span> <span class="nb">test </span>session starts <span class="o">==============================</span>
    <span class="o">=====================</span> 2 passed, 1 warnings <span class="k">in </span>6.70 seconds <span class="o">=====================</span>
Verifier completed successfully.
</code></pre></div></div> <p>Green light everywhere.</p> <ul> <li>Perfect! Green!</li> </ul> <p>Or is it? You decide to give him a little push in the right direction.</p> <ul> <li>Try running the whole test suite.</li> <li>Alright</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$molecule</span> <span class="nb">test</span>
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── destroy
    ├── syntax
    ├── lint
    ├── create
    ├── converge
    └── verify

<span class="nt">---</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'lint'</span>
<span class="nt">--</span><span class="o">&gt;</span> Executing Yamllint on files found <span class="k">in</span> /Users/sebiwi/stuff/test/nginx/...
Lint completed successfully.
<span class="nt">--</span><span class="o">&gt;</span> Executing Flake8 on files found <span class="k">in</span> /Users/sebiwi/stuff/test/nginx/molecule/default/tests/...
Lint completed successfully.
<span class="nt">--</span><span class="o">&gt;</span> Executing Ansible Lint on /Users/sebiwi/stuff/test/nginx/molecule/default/playbook.yml...
    <span class="o">[</span>ANSIBLE0012] Commands should not change things <span class="k">if </span>nothing needs doing
    /Users/sebiwi/stuff/test/nginx/tasks/main.yml:14
    Task/Handler: Start nginx
</code></pre></div></div> <p>No fireworks, no lights.</p> <ul> <li>What? Oh, that’s just ansible-lint, it often fails for that sort of thing, I’ll just deactivate it for the task.</li> </ul> <p>You stare in disbelief as N “corrects” the structure of the spell.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># tasks file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install epel release</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">epel-release</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install nginx</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Start nginx</span>
  <span class="na">command</span><span class="pi">:</span> <span class="s">systemctl start nginx</span>
  <span class="na">tags</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">skip_ansible_lint</span>
</code></pre></div></div> <p>He finishes the modifications and he casts the spell once again.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span> molecule <span class="nb">test</span>
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── destroy
    ├── syntax
    ├── lint
    ├── create
    ├── converge
    └── verify

All steps completed successfully.
</code></pre></div></div> <p>He looks at you proudly. You’re dismayed. He’s being naive and reckless. You realize that it is time to handle the situation.</p> <ul> <li>We’re green now. I think we’re finished.</li> <li>Not really. Previously, ansible-lint said that you’re changing things even if nothing needs to be done.</li> <li>Yeah, it’s because I was starting a service.</li> <li>Yes, but since you’re not using an Ansible module, you’re executing an action each time you run your playbook.</li> <li>I thought Ansible was idempotent.</li> <li>Not really. You can make idempotent code with Ansible. It doesn’t mean everything you do with it is going to be idempotent. Some things are not meant to be idempotent.</li> <li>Like what?</li> <li>Application deployments, for example. You’re deploying a new version of the application. It is meant to change things.</li> <li>I see. But this role should be idempotent.</li> <li>Certainly. You can add a new action to your default scenario test suite in order to test for idempotence.</li> </ul> <p>You close your eyes as you change the reality of the enclosure around you once again.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">scenario</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">test_sequence</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">destroy</span>
    <span class="pi">-</span> <span class="s">syntax</span>
    <span class="pi">-</span> <span class="s">lint</span>
    <span class="pi">-</span> <span class="s">create</span>
    <span class="pi">-</span> <span class="s">converge</span>
    <span class="pi">-</span> <span class="s">idempotence</span>
    <span class="pi">-</span> <span class="s">verify</span>
</code></pre></div></div> <p>You cast the spell again.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span> molecule <span class="nb">test</span>
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── destroy
    ├── syntax
    ├── lint
    ├── create
    ├── converge
    ├── idempotence
    └── verify

<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'idempotence'</span>
ERROR: Idempotence <span class="nb">test </span>failed because of the following tasks:
<span class="k">*</span> <span class="o">[</span>instance] <span class="o">=&gt;</span> nginx : Start nginx
</code></pre></div></div> <p>N looks at you.</p> <ul> <li>So we weren’t actually at green yet.</li> <li>We weren’t. Idempotence is a behaviour of our code. It also needs testing.</li> <li>I can fix it though.</li> <li>Show me.</li> </ul> <p>You hand over the control of the enclosure to N. He modifies the spell structure.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># tasks file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install epel release</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">epel-release</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install nginx</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Start nginx</span>
  <span class="na">service</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">started</span>
</code></pre></div></div> <p>You smile with relief.</p> <ul> <li>Much better. Try it.</li> <li>Right away.</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span> molecule <span class="nb">test</span>
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── destroy
    ├── syntax
    ├── lint
    ├── create
    ├── converge
    ├── idempotence
    └── verify

All steps completed successfully.
</code></pre></div></div> <ul> <li>And now we’re green.</li> <li>Yes!</li> <li>Let’s continue with our TDD approach. Red, Green, and… ?</li> <li>Refactor! Do you see any possible improvements on this code?</li> <li>Well, you could use your “Start nginx” task as a handler, which is triggered by the installation of nginx, couldn’t you?</li> <li>Yes, I could.</li> </ul> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># tasks file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install epel release</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">epel-release</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install nginx</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
  <span class="na">notify</span><span class="pi">:</span> <span class="s">Start nginx</span>
</code></pre></div></div> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># handlers file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Start nginx</span>
  <span class="na">service</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">started</span>
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span> molecule <span class="nb">test</span>
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── destroy
    ├── syntax
    ├── lint
    ├── create
    ├── converge
    ├── idempotence
    └── verify

All steps completed successfully.
</code></pre></div></div> <h3 id="n-looks-euphoric">N looks euphoric.</h3> <p>He’s applying his well-earned war experience to a whole different situation, and it is working like a charm. There’s a slight catch within your proposal, but you decide that you will let him discover it by himself.</p> <ul> <li>Wow, that worked out great! What else?</li> <li>You could have only one “yum” task and iterate over the packages that you want to install.</li> <li>Good call.</li> </ul> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># tasks file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install epel-release and nginx</span>
  <span class="na">yum</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
  <span class="na">with_items</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">epel-release</span>
    <span class="pi">-</span> <span class="s">nginx</span>
  <span class="na">notify</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">Start nginx</span>
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule <span class="nb">test</span>
...
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'converge'</span>

    PLAY <span class="o">[</span>Converge] <span class="k">****************************************************************</span>

    TASK <span class="o">[</span>Gathering Facts] <span class="k">*********************************************************</span>
    ok: <span class="o">[</span>instance]

    TASK <span class="o">[</span>nginx : Install epel-release and nginx] <span class="k">**********************************</span>
    failed: <span class="o">[</span>instance] <span class="o">(</span><span class="nv">item</span><span class="o">=[</span>u<span class="s1">'epel-release'</span>, u<span class="s1">'nginx'</span><span class="o">])</span> <span class="o">=&gt;</span> <span class="o">{</span><span class="s2">"changed"</span>: <span class="nb">false</span>, <span class="s2">"failed"</span>: <span class="nb">true</span>, <span class="s2">"item"</span>: <span class="o">[</span><span class="s2">"epel-release"</span>, <span class="s2">"nginx"</span><span class="o">]</span>, <span class="s2">"msg"</span>: <span class="s2">"No package matching 'nginx' found available, installed or updated"</span>, <span class="s2">"rc"</span>: 126, <span class="s2">"results"</span>: <span class="o">[</span><span class="s2">"No package matching 'nginx' found available, installed or updated"</span><span class="o">]}</span>

    PLAY RECAP <span class="k">*********************************************************************</span>
    instance                   : <span class="nv">ok</span><span class="o">=</span>1    <span class="nv">changed</span><span class="o">=</span>0    <span class="nv">unreachable</span><span class="o">=</span>0    <span class="nv">failed</span><span class="o">=</span>1
</code></pre></div></div> <ul> <li>Hm. I guess I need to install epel-release before I can install nginx. It doesn’t work if I do both at the same time.</li> <li>True.</li> <li>I wouldn’t had realized that without the tests. I would have done my refactoring, and it would have worked, since epel-release would already be installed on my machine when trying to install it along with nginx in a single task.</li> <li>Indeed. Also, with the current code structure, you’re not only starting nginx after installing nginx, but also after installing epel-release.</li> <li>Right. I shouldn’t. That was a test, wasn’t it?</li> <li>Maybe.</li> </ul> <p>N transforms the spell structure back to its previous form. You feel relaxed. You always feel this way after creating something impressive. You feel the same way you felt when you structured the pyramids, only to a minor extent. This time, however, the actual creator is N. You only acted as a catalyzer. The knowledge was always inside of N, he just needed to hear the right questions.</p> <p>N looks tired, but he wants to keep going.</p> <ul> <li>We just went through a full Red/Green/Refactor cycle. Sweet!</li> <li>Do you want to do another one?</li> <li>Absolutely!</li> <li>What happens if your VM gets rebooted?</li> <li>Nothing, nginx will still be installed.</li> <li>Will it be running?</li> <li>Oh, no. It won’t. Yikes.</li> <li>You should enable it then. You know what to do.</li> </ul> <p>N creates a new rule within the enclosure’s reality.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_nginx_is_enabled</span><span class="p">(</span><span class="n">host</span><span class="p">):</span>
    <span class="c"># Given</span>
    <span class="n">nginx</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="s">'nginx'</span><span class="p">)</span>

    <span class="c"># Then</span>
    <span class="k">assert</span> <span class="n">nginx</span><span class="o">.</span><span class="n">is_enabled</span>
</code></pre></div></div> <p>He claps his hands together. Red light appears everywhere.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>molecule verify
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    └── verify
<span class="nt">--</span><span class="o">&gt;</span> Scenario: <span class="s1">'default'</span>
<span class="nt">--</span><span class="o">&gt;</span> Action: <span class="s1">'verify'</span>
<span class="nt">--</span><span class="o">&gt;</span> Executing Testinfra tests found <span class="k">in</span> /Users/sebiwi/stuff/test/nginx/molecule/default/tests/…

    <span class="o">===================================</span> FAILURES <span class="o">===================================</span>
    __________________ test_nginx_is_enabled[ansible://instance] ___________________

    host <span class="o">=</span> &lt;testinfra.host.Host object at 0x103b20fd0&gt;

       def test_nginx_is_enabled<span class="o">(</span>host<span class="o">)</span>:
            <span class="c"># Given</span>
            nginx <span class="o">=</span> host.service<span class="o">(</span><span class="s1">'nginx'</span><span class="o">)</span>

            <span class="c"># Then</span>
    <span class="o">&gt;</span>       assert nginx.is_enabled
    E       assert False
    E        +  where False <span class="o">=</span> &lt;service nginx&gt;.is_enabled

    tests/test_default.py:28: AssertionError
    <span class="nt">--</span> Docs: http://doc.pytest.org/en/latest/warnings.html
    <span class="o">================</span> 1 failed, 2 passed, 1 warnings <span class="k">in </span>7.29 seconds <span class="o">================</span>
</code></pre></div></div> <ul> <li>Red.</li> <li>Go for Green.</li> </ul> <p>N modifies the structure of the spell to match the new reality constraints. He’s got a clear head now, he knows what is missing.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1"># handlers file for nginx</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Start nginx</span>
  <span class="na">service</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">state</span><span class="pi">:</span> <span class="s">started</span>
    <span class="na">enabled</span><span class="pi">:</span> <span class="s">yes</span>
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span> molecule <span class="nb">test</span>
<span class="nt">--</span><span class="o">&gt;</span> Test matrix
└── default
    ├── destroy
    ├── syntax
    ├── lint
    ├── create
    ├── converge
    ├── idempotence
    └── verify

All steps completed successfully.
</code></pre></div></div> <p>The green portal appears in front of you both. You know it is sustainable, you both tested it thoroughly. It’s a proper wizard spell. People would say it is one of your own. N looks at you and smiles.</p> <ul> <li>Green.</li> <li>Yes. Can you refactor?</li> <li>I don’t think so. It looks pretty clean to me.</li> <li>I agree.</li> </ul> <h3 id="you-do-agree">You do agree.</h3> <p>N seems in charge. He needs more time to develop himself, to learn, to become comfortable with this whole new world. You won’t be as useful during that period as you were now. It’s time to go.</p> <ul> <li>You know how to continue, right?</li> <li>Yes, I think I can manage. This is pretty cool. Thanks.</li> <li>No problem kid. Just call me if you need more help.</li> <li>Will do. Hey, do you..?</li> </ul> <p>N looks at where you used to be 10 seconds ago. You are no longer there.</p> <div class="blog-navigation"> <a class="prev" href="https://sebiwi.github.io/blog/ara/">&laquo; Ansible reporting with ARA: Ansible Run Analysis</a> <a class="next" href="https://sebiwi.github.io/blog/kubernetes-vs-docker-volumes/">Kubernetes vs Docker: Volumes! &raquo;</a> </div> <div class="related"> <h4>Related Posts</h4> <ul> <li class="relatedPost"> <a href="https://sebiwi.github.io/blog/operations-devops-soft-skills/">On Operations, DevOps and soft skills </a> </li> <li class="relatedPost"> <a href="https://sebiwi.github.io/blog/software-craftsmanship-terraform/">Software Craftsmanship and OPS scripting: a love story </a> </li> <li class="relatedPost"> <a href="https://sebiwi.github.io/blog/ansible-container/">Ansible Container: Chronicle of a death foretold </a> </li> <li class="relatedPost"> <a href="https://sebiwi.github.io/blog/the-wizard-3/">The Wizard: Scenarios </a> </li> <li class="relatedPost"> <a href="https://sebiwi.github.io/blog/the-wizard-2/">The Wizard: Side effects </a> </li> </ul> </div> <section class="author"> <div class="toleft"> <img class="selfie" src="https://sebiwi.github.io/assets/images/profile.jpg" alt="Sebiwi" alt="author selfie"> </div> <div class="toright"> <h4 class="name">Sebiwi</h4> <p class="bio">Perfectionist</p> <div class="share"> <!-- Note: Only use three share links if your site width is set to large --> <!-- If site width is set to normal, you may choose any two share links --> <a class="twitter" href="https://twitter.com/intent/tweet?text=https://sebiwi.github.io/blog/the-wizard-1/ - The Wizard: Ansible, Molecule and Test Driven Development by @sebiwicb"> <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg><span class="icon-twitter">Tweet</span> </a> <a class="facebook" href="javascript:void(0)" onclick="window.open('https://facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href), 'facebook-share-dialog', 'width=626,height=436'); return false;"> <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg><span class="icon-facebook-rect">Share</span> </a> <!-- <a class="google-plus" href="https://plus.google.com/share?url=https://sebiwi.github.io/blog/the-wizard-1/" target="_blank"> <svg class="icon icon-google-plus"><use xlink:href="#icon-google-plus"></use></svg><span class="icon-google-plus">Share</span> </a> --> <!-- <a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://sebiwi.github.io/blog/the-wizard-1/&amp;title=The Wizard: Ansible, Molecule and Test Driven Development&amp;summary=&amp;source=https://sebiwi.github.io" target="_blank"> <svg class="icon icon-linkedin"><use xlink:href="#icon-linkedin"></use></svg><span class="icon-linkedin">Share</span> </a> --> <!-- <a class="reddit" href="https://reddit.com/submit?url=https://sebiwi.github.io/blog/the-wizard-1/&amp;title=The Wizard: Ansible, Molecule and Test Driven Development" target="_blank"> <svg class="icon icon-reddit"><use xlink:href="#icon-reddit"></use></svg><span class="icon-reddit">Share</span> </a> --> </div> </div> </section> <section class="disqus"> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://sebiwi.github.io/blog/the-wizard-1/'; this.page.identifier = '/blog/the-wizard-1'; }; var disqus_shortname = 'sebiwi-github-io'; var disqus_developer = 0; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> </section> <footer class="footer-main"> Sebiwi © 2019 <a class="link" href="https://sebiwi.github.io/feed.xml" target="_blank"><svg class="icon icon-rss"><use xlink:href="#icon-rss"></use></svg></a> <p class="extra"> </p> </footer> </div> </div> <svg display="none" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <defs> <symbol id="icon-rss" viewBox="0 0 1024 1024"> <title>rss</title> <path class="path1" d="M122.88 122.88v121.19c362.803 0 656.896 294.195 656.896 656.998h121.293c0-429.773-348.416-778.189-778.189-778.189zM122.88 365.414v121.293c228.813 0 414.362 185.498 414.362 414.413h121.242c0-295.834-239.821-535.706-535.603-535.706zM239.053 668.621c-64.205 0-116.224 52.122-116.224 116.275s52.019 116.224 116.224 116.224 116.173-52.019 116.173-116.224-51.968-116.275-116.173-116.275z"></path> </symbol> <symbol id="icon-facebook" viewBox="0 0 1024 1024"> <title>facebook</title> <path class="path1" d="M870.4 51.2h-716.8c-56.32 0-102.4 46.080-102.4 102.4v716.8c0 56.371 46.080 102.4 102.4 102.4h358.4v-358.4h-102.4v-126.72h102.4v-104.96c0-110.797 62.054-188.621 192.819-188.621l92.314 0.102v133.376h-61.286c-50.893 0-70.246 38.195-70.246 73.626v86.528h131.482l-29.082 126.669h-102.4v358.4h204.8c56.32 0 102.4-46.029 102.4-102.4v-716.8c0-56.32-46.080-102.4-102.4-102.4z"></path> </symbol> <symbol id="icon-twitter" viewBox="0 0 1024 1024"> <title>twitter</title> <path class="path1" d="M886.579 319.795c0.41 8.294 0.563 16.691 0.563 24.986 0 255.488-194.406 549.99-549.888 549.99-109.21 0-210.739-32-296.294-86.886 15.155 1.792 30.515 2.714 46.080 2.714 90.624 0 173.926-30.925 240.026-82.688-84.531-1.587-155.955-57.395-180.531-134.195 11.776 2.202 23.91 3.379 36.352 3.379 17.664 0 34.765-2.304 50.944-6.707-88.422-17.818-155.034-95.898-155.034-189.594 0-0.819 0-1.587 0-2.406 26.061 14.49 55.91 23.194 87.552 24.218-51.866-34.714-86.016-93.798-86.016-160.922 0-35.379 9.523-68.608 26.214-97.178 95.283 116.992 237.773 193.894 398.387 201.984-3.277-14.182-4.966-28.877-4.966-44.083 0-106.701 86.477-193.178 193.229-193.178 55.603 0 105.83 23.398 141.107 60.979 43.981-8.704 85.35-24.781 122.726-46.899-14.438 45.107-45.107 82.995-84.992 106.906 39.117-4.71 76.288-15.002 111.002-30.413-25.907 38.81-58.675 72.806-96.461 99.994z"></path> </symbol> <symbol id="icon-github" viewBox="0 0 1024 1024"> <title>github</title> <path class="path1" d="M674.816 579.021c-36.762 0-66.56 41.318-66.56 92.109 0 50.893 29.798 92.211 66.56 92.211s66.56-41.318 66.56-92.211c-0.051-50.79-29.798-92.109-66.56-92.109zM906.547 339.251c7.629-18.688 7.936-124.877-32.512-226.611 0 0-92.723 10.189-233.011 106.496-29.44-8.192-79.258-12.186-128.973-12.186-49.818 0-99.584 3.994-129.024 12.186-140.339-96.307-233.062-106.496-233.062-106.496-40.397 101.734-39.987 207.923-32.461 226.611-47.514 51.61-76.544 113.613-76.544 198.195 0 367.923 305.306 373.811 382.31 373.811 17.51 0 52.122 0.102 88.781 0.102 36.608 0 71.27-0.102 88.678-0.102 77.107 0 382.31-5.888 382.31-373.811 0-84.582-28.979-146.586-76.493-198.195zM513.434 866.048h-2.867c-193.075 0-343.501-22.989-343.501-210.688 0-45.005 15.872-86.682 53.606-121.293 62.822-57.702 169.216-27.187 289.894-27.187 0.512 0 1.024 0 1.485 0 0.512 0 0.922 0 1.382 0 120.678 0 227.123-30.515 289.997 27.187 37.632 34.611 53.504 76.288 53.504 121.293 0 187.699-150.374 210.688-343.501 210.688zM349.235 579.021c-36.762 0-66.56 41.318-66.56 92.109 0 50.893 29.798 92.211 66.56 92.211 36.813 0 66.611-41.318 66.611-92.211 0-50.79-29.798-92.109-66.611-92.109z"></path> </symbol> <symbol id="icon-youtube" viewBox="0 0 1024 1024"> <title>youtube</title> <path class="path1" d="M512 117.76c-503.194 0-512 44.749-512 394.24s8.806 394.24 512 394.24 512-44.749 512-394.24-8.806-394.24-512-394.24zM676.096 529.101l-229.888 107.315c-20.122 9.318-36.608-1.126-36.608-23.347v-202.138c0-22.17 16.486-32.666 36.608-23.347l229.888 107.315c20.122 9.421 20.122 24.781 0 34.202z"></path> </symbol> <symbol id="icon-mail" viewBox="0 0 1024 1024"> <title>mail</title> <path class="path1" d="M80.589 270.643c24.986 13.414 371.098 199.373 384 206.285s29.594 10.189 46.387 10.189c16.794 0 33.485-3.277 46.387-10.189s359.014-192.87 384-206.285c25.037-13.466 48.691-65.843 2.765-65.843h-866.253c-45.926 0-22.272 52.378 2.714 65.843zM952.986 383.437c-28.416 14.797-378.214 197.069-395.622 206.182s-29.594 10.189-46.387 10.189-28.979-1.075-46.387-10.189-365.21-191.437-393.626-206.234c-19.968-10.445-19.763 1.792-19.763 11.213s0 373.402 0 373.402c0 21.504 28.979 51.2 51.2 51.2h819.2c22.221 0 51.2-29.696 51.2-51.2 0 0 0-363.93 0-373.35s0.205-21.658-19.814-11.213z"></path> </symbol> <symbol id="icon-spotify" viewBox="0 0 1024 1024"> <title>spotify</title> <path class="path1" d="M512 61.44c-248.883 0-450.56 201.626-450.56 450.56 0 248.781 201.677 450.56 450.56 450.56 248.934 0 450.509-201.728 450.509-450.56 0-248.883-201.523-450.56-450.509-450.56zM690.074 742.502c-8.858 0-15.053-3.379-21.555-7.322-60.877-36.915-136.294-56.269-218.010-56.269-41.677 0-86.682 4.966-133.632 14.592l-5.734 1.434c-5.939 1.434-12.032 3.021-16.691 3.021-18.995 0-33.843-14.746-33.843-33.587 0-19.098 10.752-32.614 28.774-35.994 56.115-12.8 108.954-19.046 161.382-19.046 94.976 0 179.866 22.016 252.467 65.485 12.442 7.27 20.275 15.667 20.275 34.202-0.051 18.483-15.002 33.485-33.434 33.485zM736.819 611.379c-10.598 0-17.562-4.045-23.706-7.629-109.722-65.075-273.050-86.682-407.603-50.842-2.253 0.666-4.301 1.28-6.144 1.894-5.069 1.587-9.779 3.174-16.435 3.174-22.118 0-40.090-18.074-40.090-40.346 0-21.453 11.213-36.454 31.437-42.189 51.866-14.234 100.557-23.654 170.65-23.654 113.254 0 223.078 28.416 309.146 79.923 15.667 8.96 22.784 21.197 22.784 39.475 0 22.221-17.971 40.192-40.038 40.192zM789.862 461.875c-9.984 0-16.128-2.406-25.344-7.373-74.394-44.646-190.464-71.219-310.733-71.219-62.669 0-119.603 6.912-169.267 20.326-1.69 0.41-3.277 0.87-5.018 1.382-5.274 1.587-11.878 3.482-18.688 3.482-26.419 0-47.053-20.89-47.053-47.565 0-23.194 13.005-40.909 34.816-47.36 59.955-17.715 128.973-26.675 205.107-26.675 137.114 0 267.571 30.464 357.939 83.507 16.998 9.677 25.344 24.32 25.344 44.646 0 26.266-20.685 46.848-47.104 46.848z"></path> </symbol> <symbol id="icon-instagram" viewBox="0 0 1024 1024"> <title>instagram</title> <path class="path1" d="M870.4 51.2h-716.8c-56.32 0-102.4 46.080-102.4 102.4v716.8c0 56.371 46.080 102.4 102.4 102.4h716.8c56.32 0 102.4-46.029 102.4-102.4v-716.8c0-56.32-46.080-102.4-102.4-102.4zM511.181 794.778c156.621 0 283.546-127.027 283.546-283.597 0-17.306-2.202-33.997-5.274-50.381h80.947v369.459c0 19.558-15.872 35.328-35.482 35.328h-645.837c-19.61 0-35.482-15.77-35.482-35.328v-369.459h79.309c-3.123 16.384-5.325 33.075-5.325 50.381 0 156.621 127.027 283.597 283.597 283.597zM333.978 511.181c0-97.894 79.36-177.203 177.254-177.203 97.843 0 177.254 79.309 177.254 177.203s-79.411 177.254-177.254 177.254c-97.946 0-177.254-79.36-177.254-177.254zM834.918 307.2h-82.688c-19.558 0-35.43-15.974-35.43-35.43v-82.79c0-19.558 15.872-35.379 35.379-35.379h82.688c19.661 0 35.533 15.821 35.533 35.379v82.739c0 19.507-15.872 35.482-35.482 35.482z"></path> </symbol> <symbol id="icon-linkedin" viewBox="0 0 1024 1024"> <title>linkedin</title> <path class="path1" d="M256 153.6c0 54.374-36.352 101.171-102.451 101.171-62.208 0-102.349-44.134-102.349-98.509 0-55.808 38.912-105.062 102.4-105.062s101.171 46.592 102.4 102.4zM51.2 972.8v-665.6h204.8v665.6h-204.8z"></path> <path class="path2" d="M358.4 534.733c0-79.104-2.611-145.203-5.222-202.291h184.013l9.114 88.218h3.891c25.907-41.523 89.395-102.4 195.686-102.4 129.638 0 226.918 86.784 226.918 273.51v381.030h-204.8v-351.283c0-81.613-31.078-143.872-102.4-143.872-54.374 0-81.613 44.032-95.898 80.333-5.222 13.005-6.502 31.13-6.502 49.306v365.517h-204.8v-438.067z"></path> </symbol> <symbol id="icon-google" viewBox="0 0 1024 1024"> <title>google</title> <path class="path1" d="M522.2 438.8v175.6h290.4c-11.8 75.4-87.8 220.8-290.4 220.8-174.8 0-317.4-144.8-317.4-323.2s142.6-323.2 317.4-323.2c99.4 0 166 42.4 204 79l139-133.8c-89.2-83.6-204.8-134-343-134-283 0-512 229-512 512s229 512 512 512c295.4 0 491.6-207.8 491.6-500.2 0-33.6-3.6-59.2-8-84.8l-483.6-0.2z"></path> </symbol> <symbol id="icon-google-plus" viewBox="0 0 1317 1024"> <title>google-plus</title> <path class="path1" d="M821.143 521.714q0 118.857-49.714 211.714t-141.714 145.143-210.857 52.286q-85.143 0-162.857-33.143t-133.714-89.143-89.143-133.714-33.143-162.857 33.143-162.857 89.143-133.714 133.714-89.143 162.857-33.143q163.429 0 280.571 109.714l-113.714 109.143q-66.857-64.571-166.857-64.571-70.286 0-130 35.429t-94.571 96.286-34.857 132.857 34.857 132.857 94.571 96.286 130 35.429q47.429 0 87.143-13.143t65.429-32.857 44.857-44.857 28-47.429 12.286-42.286h-237.714v-144h395.429q6.857 36 6.857 69.714zM1316.571 452v120h-119.429v119.429h-120v-119.429h-119.429v-120h119.429v-119.429h120v119.429h119.429z"></path> </symbol> <symbol id="icon-pinterest" viewBox="0 0 1024 1024"> <title>pinterest</title> <path class="path1" d="M512 68.4c-245 0-443.6 198.6-443.6 443.6 0 188 117 348.4 282 413-3.8-35-7.4-89 1.6-127.2 8-34.6 52-220.4 52-220.4s-13.2-26.6-13.2-65.8c0-61.6 35.8-107.8 80.2-107.8 37.8 0 56.2 28.4 56.2 62.4 0 38-24.2 95-36.8 147.6-10.6 44.2 22 80.2 65.6 80.2 78.8 0 139.4-83.2 139.4-203.2 0-106.2-76.4-180.4-185.2-180.4-126.2 0-200.2 94.6-200.2 192.6 0 38.2 14.6 79 33 101.2 3.6 4.4 4.2 8.2 3 12.8-3.4 14-10.8 44.2-12.4 50.4-2 8.2-6.4 9.8-14.8 6-55.4-25.8-90-106.8-90-171.8 0-140 101.6-268.4 293-268.4 153.8 0 273.4 109.6 273.4 256.2 0 152.8-96.4 276-230.2 276-45 0-87.2-23.4-101.6-51 0 0-22.2 84.6-27.6 105.4-10 38.6-37 86.8-55.2 116.2 41.6 12.8 85.6 19.8 131.4 19.8 245 0 443.6-198.6 443.6-443.6 0-245.2-198.6-443.8-443.6-443.8z"></path> </symbol> <symbol id="icon-medium" viewBox="0 0 179.2 179.2"> <title>medium</title> <path transform="scale(0.1,-0.1) translate(0,-1536)" d="M597 1115v-1173q0 -25 -12.5 -42.5t-36.5 -17.5q-17 0 -33 8l-465 233q-21 10 -35.5 33.5t-14.5 46.5v1140q0 20 10 34t29 14q14 0 44 -15l511 -256q3 -3 3 -5zM661 1014l534 -866l-534 266v600zM1792 996v-1054q0 -25 -14 -40.5t-38 -15.5t-47 13l-441 220zM1789 1116 q0 -3 -256.5 -419.5t-300.5 -487.5l-390 634l324 527q17 28 52 28q14 0 26 -6l541 -270q4 -2 4 -6z" /> </symbol> <symbol id="icon-vimeo" viewBox="0 0 21 21"> <title>vimeo</title> <path d="M17.811,2.018c2.017,0.053,3.026,1.198,3.036,3.438c0,0.147-0.005,0.3-0.013,0.457c-0.089,1.899-1.502,4.486-4.245,7.76 c-2.829,3.43-5.229,5.147-7.2,5.156c-1.226,0-2.244-1.05-3.061-3.151l-0.858-2.88L4.622,9.922C3.997,7.838,3.329,6.798,2.616,6.798 c-0.156,0-0.697,0.304-1.626,0.91L0,6.537l1.536-1.276l1.511-1.263C4.4,2.914,5.429,2.328,6.135,2.241 c0.094-0.01,0.188-0.013,0.284-0.013c1.449,0,2.354,1.041,2.709,3.124C9.326,6.54,9.49,7.506,9.623,8.248 C9.752,8.992,9.86,9.51,9.946,9.805c0.479,1.97,0.995,2.96,1.55,2.968c0.426,0,1.082-0.642,1.968-1.926 c0.866-1.319,1.332-2.296,1.392-2.932c0.019-0.129,0.026-0.25,0.026-0.362c0-0.861-0.474-1.29-1.418-1.29 c-0.479,0-0.99,0.102-1.537,0.299c0.98-3.021,2.864-4.534,5.65-4.544C17.655,2.018,17.732,2.018,17.811,2.018z"/> </symbol> <symbol id="icon-stackoverflow" viewBox="0 0 878 1024"> <title>stackoverflow</title> <path class="path1" d="M736.571 932.571h-638.857v-274.286h-91.429v365.714h821.714v-365.714h-91.429v274.286zM198.286 633.143l18.857-89.714 447.429 94.286-18.857 89.143zM257.143 419.429l38.286-83.429 414.286 193.714-38.286 82.857zM372 216l58.286-70.286 350.857 293.143-58.286 70.286zM598.857 0l272.571 366.286-73.143 54.857-272.571-366.286zM188.571 840.571v-90.857h457.143v90.857h-457.143z"></path> </symbol> <symbol id="icon-reddit" viewBox="0 0 1024 1024"> <title>reddit</title> <path class="path1" d="M1024 483.429q0 33.143-16.857 60.286t-45.429 41.429q6.857 26.286 6.857 54.857 0 88.571-60.857 164t-166 119.143-228.571 43.714-228.286-43.714-165.714-119.143-60.857-164q0-26.857 6.286-53.714-29.143-14.286-46.857-42t-17.714-60.857q0-46.857 33.143-80.286t80.571-33.429q48.571 0 82.857 36 124.571-86.857 294.286-92.571l66.286-297.714q1.714-7.429 8.571-12t14.857-2.857l210.857 46.286q10.286-21.143 30.857-34t45.143-12.857q35.429 0 60.571 24.857t25.143 60.286-25.143 60.571-60.571 25.143-60.286-24.857-24.857-60.286l-190.857-42.286-59.429 269.714q171.429 5.143 296.571 91.429 33.143-34.857 81.714-34.857 47.429 0 80.571 33.429t33.143 80.286zM238.857 597.143q0 35.429 24.857 60.571t60.286 25.143 60.571-25.143 25.143-60.571-25.143-60.286-60.571-24.857q-34.857 0-60 25.143t-25.143 60zM701.714 800q6.286-6.286 6.286-14.857t-6.286-14.857q-5.714-5.714-14.286-5.714t-14.857 5.714q-23.429 24-69.143 35.429t-91.429 11.429-91.429-11.429-69.143-35.429q-6.286-5.714-14.857-5.714t-14.286 5.714q-6.286 5.714-6.286 14.571t6.286 15.143q24.571 24.571 67.714 38.857t70 16.857 52 2.571 52-2.571 70-16.857 67.714-38.857zM700 682.857q35.429 0 60.286-25.143t24.857-60.571q0-34.857-25.143-60t-60-25.143q-35.429 0-60.571 24.857t-25.143 60.286 25.143 60.571 60.571 25.143z"></path> </symbol> <symbol id="icon-quora" viewBox="0 0 76 76"> <title>quora</title> <path class="path1" d="M67.9,59.1c0,0-0.4,5.3-5.2,5.3c-3.7,0-6.3-2.8-8.7-6.5c6.8-5.9,11.1-14.7,11.1-24.6C65.1,15.4,51.1,1,33.8,1 S2.6,15.4,2.6,33.2s14,32.2,31.3,32.2c3.1,0,6.2-0.5,9-1.4C46.5,69.8,51,75,58.2,75c14.6,0,15.2-15.9,15.2-15.9L67.9,59.1 L67.9,59.1z M33.8,60.2c-10.1,0-18.2-12.1-18.2-26.9S23.8,6.3,33.8,6.3s18.2,12.1,18.2,26.9c0,5.9-1.3,11.4-3.5,15.8 c-2.5-3.5-5.4-6.5-9.7-7.5c-7.5-1.7-14,1.7-16.1,3.4l1.9,4c0,0,2-1.1,6.8,0c3.1,0.7,5.4,4.9,8.1,9.8C37.9,59.7,35.9,60.2,33.8,60.2 z"></path> </symbol> </defs> </svg> <!-- Google Analytics Tracking code --> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', '']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>
